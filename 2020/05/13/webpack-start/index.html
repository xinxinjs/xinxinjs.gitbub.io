<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css">


  <meta name="keywords" content="webpack,">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.png?v=5.1.0">






<meta name="description" content="创建新建空的目录webpack-first 初始化package.json文件：进入webpack-first文件夹运行 npm init -y命令 在项目内安装webpack：命令行运行 npm install webpack webpack-cli --save-dev 新建src目录，在src目录下新建index.js文件 安装完成，打印一下webpack版本：命令行执行./node_mod">
<meta name="keywords" content="webpack">
<meta property="og:type" content="article">
<meta property="og:title" content="Webpack配置-基础配置">
<meta property="og:url" content="http://yoursite.com/2020/05/13/webpack-start/index.html">
<meta property="og:site_name" content="小心心的笔记">
<meta property="og:description" content="创建新建空的目录webpack-first 初始化package.json文件：进入webpack-first文件夹运行 npm init -y命令 在项目内安装webpack：命令行运行 npm install webpack webpack-cli --save-dev 新建src目录，在src目录下新建index.js文件 安装完成，打印一下webpack版本：命令行执行./node_mod">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/img/webpack/w1.png">
<meta property="og:image" content="http://yoursite.com/img/webpack/w3.png">
<meta property="og:image" content="http://yoursite.com/img/webpack/w4.png">
<meta property="og:image" content="http://yoursite.com/img/webpack/w5.png">
<meta property="og:image" content="http://yoursite.com/img/webpack/w6.png">
<meta property="og:image" content="http://yoursite.com/img/webpack/w7.png">
<meta property="og:image" content="http://yoursite.com/img/webpack/w8.png">
<meta property="og:image" content="http://yoursite.com/img/webpack/w9.png">
<meta property="og:image" content="http://yoursite.com/img/webpack/w10.png">
<meta property="og:image" content="http://yoursite.com/img/webpack/w11.png">
<meta property="og:updated_time" content="2020-05-27T08:22:55.699Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Webpack配置-基础配置">
<meta name="twitter:description" content="创建新建空的目录webpack-first 初始化package.json文件：进入webpack-first文件夹运行 npm init -y命令 在项目内安装webpack：命令行运行 npm install webpack webpack-cli --save-dev 新建src目录，在src目录下新建index.js文件 安装完成，打印一下webpack版本：命令行执行./node_mod">
<meta name="twitter:image" content="http://yoursite.com/img/webpack/w1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 'undefined',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/05/13/webpack-start/">





  <title> Webpack配置-基础配置 | 小心心的笔记 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">小心心的笔记</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <p class="site-subtitle">不务正业的前端</p>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-message">
          <a href="/message" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-external-link"></i> <br>
            
            留言
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/13/webpack-start/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="小心心">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/images/headphoto.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="小心心的笔记">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="小心心的笔记" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Webpack配置-基础配置
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-13T14:20:34+08:00">
                2020-05-13
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h2><p>新建空的目录webpack-first</p>
<p>初始化package.json文件：进入webpack-first文件夹运行 <code>npm init -y</code>命令</p>
<p>在项目内安装webpack：命令行运行 <code>npm install webpack webpack-cli --save-dev</code></p>
<p>新建src目录，在src目录下新建index.js文件</p>
<p>安装完成，打印一下webpack版本：命令行执行<code>./node_modules/.bin/webpack</code>命令</p>
<p><img src="/img/webpack/w1.png" alt="打印webpack版本"></p>
<h2 id="尝试运行"><a href="#尝试运行" class="headerlink" title="尝试运行"></a>尝试运行</h2><p>webpack的配置文件是在根目录下webpack.config.js文件里面配置</p>
<p>webpack的配置主要配置的是：</p>
<ol>
<li><p>基础功能：入口，出口文件配置</p>
</li>
<li><p>转换器loader</p>
</li>
<li><p>插件plugins</p>
</li>
</ol>
<p>在根目录新建webpack.config.js这个文件，简单配置一下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> webpackConfig = &#123;</span><br><span class="line">  mode: <span class="string">'production'</span>,</span><br><span class="line">  entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>), <span class="comment">//必须是绝对路径</span></span><br><span class="line">    filename: <span class="string">'boundle.js'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = webpackConfig;</span><br></pre></td></tr></table></figure>
<p>在src新建helloWorld文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ./src/helloWorld.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">helloWorld</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'hello world'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>index.js引入helloWorld</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; helloWorld &#125; <span class="keyword">from</span> <span class="string">'./helloWorld'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.write(helloWorld());</span><br></pre></td></tr></table></figure>
<p>运行 <code>./node_modules/.bin/webpack</code>，不添加任何参数就是不指定配置文件，打包结果会在根目录下面的dist目录生成一个boundle.js文件</p>
<h3 id="每次运行-node-modules-bin-webpack一长串太麻烦了"><a href="#每次运行-node-modules-bin-webpack一长串太麻烦了" class="headerlink" title="每次运行./node_modules/.bin/webpack一长串太麻烦了"></a>每次运行<code>./node_modules/.bin/webpack</code>一长串太麻烦了</h3><p>./node_modules/.bin/目录下存放的是该项目所有依赖的软连接，所有需要从./node_modules/.bin/目录启动webpack来打包项目，实际上呢package.json文件可以默认读取到./node_modules/.bin/目录下的命令，在package.json增加一个scripts配置，执行build命令的时候会去./node_modules/.bin/目录下寻找webpack命令，然后执行</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"webpack-first"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="attr">"main"</span>: <span class="string">"index.js"</span>,</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>,</span><br><span class="line">    <span class="attr">"build"</span>: <span class="string">"webpack"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"keywords"</span>: [],</span><br><span class="line">  <span class="attr">"author"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="attr">"license"</span>: <span class="string">"ISC"</span>,</span><br><span class="line">  <span class="attr">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="attr">"webpack"</span>: <span class="string">"^4.43.0"</span>,</span><br><span class="line">    <span class="attr">"webpack-cli"</span>: <span class="string">"^3.3.11"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在可以直接执行<code>npm run build</code>打包项目了</p>
<h2 id="简单了解webpack核心概念"><a href="#简单了解webpack核心概念" class="headerlink" title="简单了解webpack核心概念"></a>简单了解webpack核心概念</h2><h3 id="entry指定打包的入口"><a href="#entry指定打包的入口" class="headerlink" title="entry指定打包的入口"></a>entry指定打包的入口</h3><p>webpack是模块打包器，一切皆模块，不仅是代码模块，图片、字体、文本都会当成一个个模块，模块之间的依赖关系根据入口文件entry寻找，生成一颗依赖树，在打包的过程中如果发现依赖关系，就把文件加入依赖树中，最终生成打包后的资源</p>
<p>单入口的entry是一个字符串</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">entry: <span class="string">'./src/index.js'</span>,</span><br></pre></td></tr></table></figure>
<p>多入口的entry是一个对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">entry: &#123;</span><br><span class="line">  app: <span class="string">'./src/index.js'</span>,</span><br><span class="line">  pc: <span class="string">'./src/pc.js'</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h3 id="output指定webpack编译打包后的文件如何输出到磁盘"><a href="#output指定webpack编译打包后的文件如何输出到磁盘" class="headerlink" title="output指定webpack编译打包后的文件如何输出到磁盘"></a>output指定webpack编译打包后的文件如何输出到磁盘</h3><p>单入口对应单个的output配置</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">  filename: <span class="string">''</span>,</span><br><span class="line">  path: <span class="string">''</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>多入口对应多个output配置</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">  filename: <span class="string">'[name].js'</span>,</span><br><span class="line">  path: <span class="string">''</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h3 id="尝试多入口配置"><a href="#尝试多入口配置" class="headerlink" title="尝试多入口配置"></a>尝试多入口配置</h3><p>在src目录下新建一个login.js文件作为另外一个入口文件，随便写点什么可执行的代码进去</p>
<p>然后修改webpack.config.js这个文件，修改entry字段和output字段以配置多入口</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> webpackConfig = &#123;</span><br><span class="line">  ...</span><br><span class="line">  entry: &#123;</span><br><span class="line">    index: <span class="string">'./src/index.js'</span>,</span><br><span class="line">    login: <span class="string">'./src/login.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>), <span class="comment">// 必须是绝对路径</span></span><br><span class="line">    filename: <span class="string">'[name].js'</span>, <span class="comment">// 使用占位符为每个入口打包之后的文件命名</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = webpackConfig;</span><br></pre></td></tr></table></figure>
<p>运行<code>rm -rf dist/</code>删除dist目录下已经生成的打包文件，再次执行npm run build 会发现dist目录下面新生成了两个文件：index.js,login.js</p>
<h3 id="loaders"><a href="#loaders" class="headerlink" title="loaders"></a>loaders</h3><p>对于webpack不能解析的文件（es6,7以及更高版本，less文件，image文件等）通过loaders先转换一下</p>
<p>基本用法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> webpackConfig = &#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.txt$/</span>, <span class="comment">// 匹配规则</span></span><br><span class="line">        use: <span class="string">'css-loader'</span> <span class="comment">// 要使用的loader</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = webpackConfig;</span><br></pre></td></tr></table></figure>
<h3 id="plugins"><a href="#plugins" class="headerlink" title="plugins"></a>plugins</h3><p>用于优化打包出来的文件，资源管理和环境变量的注入，作用于整个构建过程</p>
<h3 id="mode-webpack4新提出的概念"><a href="#mode-webpack4新提出的概念" class="headerlink" title="mode  webpack4新提出的概念"></a>mode  webpack4新提出的概念</h3><p>指定当前的构建环境：production（默认），development，none</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>development</td>
<td>设置process.env.NODE_ENV设置为development，开启 NamedChunksPlugin和NamedModulesPlugin</td>
<td>NamedChunksPlugin：把chunk id变为一个字符串标识符。NamedModulesPlugin：当开启 HMR 的时候使用该插件会显示模块的相对路径，建议用于开发环境。</td>
</tr>
<tr>
<td>production</td>
<td>设置process.env.NODE_ENV设置为production，开启 FlagDependencyUsagePlugin, FlagIncludedChunksPlugin, ModuleConcatenationPlugin, NoEmitOnErrorsPlugin, OccurrenceOrderPlugin, SideEffectsFlagPlugin 和 UglifyJsPlugin</td>
<td>启用生产环境适用的插件，比如代码压缩，去注释等</td>
</tr>
</tbody>
</table>
<h2 id="了解webpack基础用法"><a href="#了解webpack基础用法" class="headerlink" title="了解webpack基础用法"></a>了解webpack基础用法</h2><h3 id="在浏览器中查看页面"><a href="#在浏览器中查看页面" class="headerlink" title="在浏览器中查看页面"></a>在浏览器中查看页面</h3><p>为了查看webpack基础用法配置之后的页面，需要 html 文件，可以使用 html-webpack-plugin 插件来帮助。</p>
<p>首先安装一下：<code>npm install html-webpack-plugin -D</code></p>
<p>新建 public 目录，并在其中新建一个 index.html 文件( 文件内容使用 html:5 快捷生成即可)</p>
<p>修改 webpack.config.js 文件。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//首先引入插件</span></span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="comment">//数组 放着所有的webpack插件</span></span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            template: <span class="string">'./public/index.html'</span>,</span><br><span class="line">            filename: <span class="string">'index.html'</span>, <span class="comment">//打包后的文件名</span></span><br><span class="line">            minify: &#123;</span><br><span class="line">                removeAttributeQuotes: <span class="literal">false</span>, <span class="comment">//是否删除属性的双引号</span></span><br><span class="line">                collapseWhitespace: <span class="literal">false</span>, <span class="comment">//是否折叠空白</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// hash: true //是否加上hash，默认是 false</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行npm run build，dist目录下新生成一个index.html的文件，打开dist目录，双击在浏览器打开这个文件，可以看到页面内显示的hello world文本</p>
<h3 id="Babel-loader-解析es6和jsx"><a href="#Babel-loader-解析es6和jsx" class="headerlink" title="Babel-loader 解析es6和jsx"></a>Babel-loader 解析es6和jsx</h3><h4 id="babel如何解析es语法"><a href="#babel如何解析es语法" class="headerlink" title="babel如何解析es语法"></a>babel如何解析es语法</h4><p>首先安装：<code>npm i @babel/core @babel/preset-env babel-loader -D</code></p>
<p>Babel-loader执行依赖Babel的配置文件.babelrc，在根目录新建.babelrc文件，写入代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .babelrc</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [<span class="string">"@babel/preset-env"</span>] <span class="comment">//预设一组es6的插件</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后修改webpack.config.js这个文件，增加babel-sloader的配置，手动设置一下<code>mode: &#39;development&#39;</code>，一会打包的时候可以看到打包出来的代码不会被压缩</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">const</span> webpackConfig = &#123;</span><br><span class="line">  ...</span><br><span class="line">  mode: <span class="string">'development'</span>,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">      test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">      use: <span class="string">'babel-loader'</span></span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = webpackConfig;</span><br></pre></td></tr></table></figure>
<p>测试一下：打开之前新建的src/login文件，修改代码：特意使用es6的箭头函数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/login</span></span><br><span class="line"><span class="keyword">const</span> login = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'login page'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行npm run build可以看到在dist目录下构建出的login.js里面的函数被转换成普通的function函数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dist/login.js代码片段</span></span><br><span class="line"><span class="comment">/***/</span> <span class="string">"./src/login.js"</span>:</span><br><span class="line"><span class="comment">/*!**********************!*\</span></span><br><span class="line"><span class="comment">  !*** ./src/login.js ***!</span></span><br><span class="line"><span class="comment">  \**********************/</span></span><br><span class="line"><span class="comment">/*! no static exports found */</span></span><br><span class="line"><span class="comment">/***/</span> (<span class="function"><span class="keyword">function</span>(<span class="params">module, exports</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">eval</span>(<span class="string">"var login = function login() &#123;\n  console.log('login page');\n&#125;;\n\n//# sourceURL=webpack:///./src/login.js?"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/***/</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/******/</span> &#125;);</span><br></pre></td></tr></table></figure>
<h4 id="Babel如何转换jsx或者vuex语法"><a href="#Babel如何转换jsx或者vuex语法" class="headerlink" title="Babel如何转换jsx或者vuex语法"></a>Babel如何转换jsx或者vuex语法</h4><p>为了测试babel解析jsx语法，首先安装一下react以及要解析jsx所需要的的babel/preset-react：<code>npm i react react-dom @babel/preset-react -D</code></p>
<p>安装完成在.babelrc文件增加preset-react配置</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [..., <span class="string">"@babel/preset-react"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>为了测试效果，修改src/index.js文件的代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> react <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> reactdom <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span> <span class="keyword">extends</span> <span class="title">react</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>hello world react<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">reactdom.render(<span class="xml"><span class="tag">&lt;<span class="name">Index</span> /&gt;</span>, document.getElementById('root'))</span></span><br></pre></td></tr></table></figure>
<p>在public/index.html新增target节点 id=”root”</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- public/index.html --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 新增 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>运行npm run build，在浏览器刷新index.html页面，发现网页显示的文本变成hello world react</p>
<h3 id="解析css"><a href="#解析css" class="headerlink" title="解析css"></a>解析css</h3><h4 id="css-loader用于加载-css文件，并且转换成commonjs文件，style-loader将样式通过style标签插入到head中"><a href="#css-loader用于加载-css文件，并且转换成commonjs文件，style-loader将样式通过style标签插入到head中" class="headerlink" title="css-loader用于加载.css文件，并且转换成commonjs文件，style-loader将样式通过style标签插入到head中"></a>css-loader用于加载.css文件，并且转换成commonjs文件，style-loader将样式通过style标签插入到head中</h4><p>首先安装css-loader，style-loader: <code>npm i style-loader css-loader -D</code></p>
<p>新建src/index.css文件，写入样式</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.text</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: pink;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后在index.js文件中引入这个样式，并且修改react组件使用这个样式:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">import</span> styles <span class="keyword">from</span> <span class="string">'./index.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span> <span class="keyword">extends</span> <span class="title">react</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">className</span>=<span class="string">"text"</span>&gt;</span>hello world react<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>最后不要忘了在webpack.config.js文件配置css-loader</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">const</span> webpackConfig = &#123;</span><br><span class="line">  ...</span><br><span class="line">  mode: <span class="string">'development'</span>,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      ...</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [<span class="string">'style-loader'</span>,<span class="string">'css-loader'</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = webpackConfig;</span><br></pre></td></tr></table></figure>
<p>注意loader的解析是链式解析，总右往左，所以上面的loader的执行顺序是先使用css-loader解析css，然后将解析好的文件传递给style-loader再进行下一步的工作</p>
<p>运行npm run build，在浏览器刷新index.html，可以看到文字变成了粉色</p>
<h4 id="如何使用less-loader和sass-loader"><a href="#如何使用less-loader和sass-loader" class="headerlink" title="如何使用less-loader和sass-loader"></a>如何使用less-loader和sass-loader</h4><p>less-loader和sass-loader的使用和css-loader的使用方法类似，以下以less为例，less-loader就是将less.css转换成css，</p>
<p>首先安装less 和 less-loader：<code>npm i less less-loader -D</code></p>
<p>修改刚才的index.css文件后缀名为index.less，并写点简单的样式：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.less</span></span><br><span class="line"><span class="variable">@base:</span> <span class="number">#f938ab</span>;</span><br><span class="line"><span class="selector-class">.text</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="variable">@base</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>index.js中引入index.less</p>
<p>在webpack.config.js文件配置less-loader</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">const</span> webpackConfig = &#123;</span><br><span class="line">  ...</span><br><span class="line">  mode: <span class="string">'development'</span>,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      ...</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">        use: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = webpackConfig;</span><br></pre></td></tr></table></figure>
<p>运行npm run build，在浏览器刷新index.html，可以看到文字变成新设置的颜色</p>
<h3 id="解析图片和字体资源"><a href="#解析图片和字体资源" class="headerlink" title="解析图片和字体资源"></a>解析图片和字体资源</h3><h4 id="file-loader解析图片文件"><a href="#file-loader解析图片文件" class="headerlink" title="file-loader解析图片文件"></a>file-loader解析图片文件</h4><p>使用<code>file-loader</code>解析文件资源，首先安装一下:<code>npm i file-loader -D</code>，安装完成之后，在src下新建一个img文件夹，用来存放图片资源，照一张漂亮的图片放进img文件夹</p>
<p>在index.js中引用这张图片：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xiaozhan <span class="keyword">from</span> <span class="string">'./img/zhanzhan.jpg'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line">      &lt;img src=&#123;xiaozhan&#125; /&gt;</span><br><span class="line">    &lt;/&gt;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后在webpack.config.js文件配置file-loader，匹配一些常用的图片文件后缀</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">const</span> webpackConfig = &#123;</span><br><span class="line">  ...</span><br><span class="line">  mode: <span class="string">'development'</span>,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      ...</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpg|gif|jpeg)$/</span>,</span><br><span class="line">        use: [<span class="string">'file-loader'</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = webpackConfig;</span><br></pre></td></tr></table></figure>
<p>运行npm run build，在浏览器刷新index.html，可以看到页面增加了一个图片文件</p>
<p><img src="/img/webpack/w3.png" alt="图片"></p>
<h4 id="file-loader解析字体"><a href="#file-loader解析字体" class="headerlink" title="file-loader解析字体"></a>file-loader解析字体</h4><p>字体文件的解析与图片文件一样可以使用file-loader</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">const</span> webpackConfig = &#123;</span><br><span class="line">  ...</span><br><span class="line">  mode: <span class="string">'development'</span>,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      ...</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(woff|woff2|eot|otf|ttf)$/</span>,</span><br><span class="line">        use: [<span class="string">'file-loader'</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = webpackConfig;</span><br></pre></td></tr></table></figure>
<h4 id="解析图片和字体文件也可以使用url-loader"><a href="#解析图片和字体文件也可以使用url-loader" class="headerlink" title="解析图片和字体文件也可以使用url-loader"></a>解析图片和字体文件也可以使用url-loader</h4><p>url-loader可以较小资源自动base64转换，看一下使用的效果</p>
<p>首先安装：<code>npm i url-loader -D</code></p>
<p>然后修改webpack.config.js的配置，把file-loader替换成url-loader</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">const</span> webpackConfig = &#123;</span><br><span class="line">  ...</span><br><span class="line">  mode: <span class="string">'development'</span>,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      ...</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpg|gif|jpeg)$/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">'url-loader'</span>,</span><br><span class="line">          options: &#123;</span><br><span class="line">            limit: <span class="number">10240</span>, <span class="comment">// 图片小于10k，webpack在打包的时候会自动用base64转换</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = webpackConfig;</span><br></pre></td></tr></table></figure>
<p>找一个小于10k的图片测试一下，首先看一下使用file-loader打包的文件，dist目录下打包出来了图片文件，index.js是848k，图片文件6.9k</p>
<p><img src="/img/webpack/w4.png" alt="图片"></p>
<p>然后删除掉dist目录，使用url-loader的配置再打包一次，</p>
<p><img src="/img/webpack/w5.png" alt="图片"></p>
<p>可以看到，dist目录下打包出来的文件并没有图片文件，而index.js文件变成了857k，因为图片使用base64转行进去了，刷新页面，看到的页面和刚才一样的</p>
<h3 id="webpack中文件的监听"><a href="#webpack中文件的监听" class="headerlink" title="webpack中文件的监听"></a>webpack中文件的监听</h3><p>刚才一系列操作，每次做点什么代码上的改动都要手动build，手动刷新页面，极其不方便</p>
<p>文件的监听就是在发现源代码发生变化的时候，自动重新构建出新的输出文件</p>
<p>webpack中开启监听有两种方式：</p>
<ul>
<li>启动webpack命令时带上 –watch参数，在package.json增加一个scripts配置</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  ...</span><br><span class="line">  "scripts": &#123;</span><br><span class="line">    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1",</span><br><span class="line">    "build": "webpack",</span><br><span class="line">    "watch": "webpack --watch"</span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>修改了之后，在命令行输入 npm run watch，命令行提示 ：webpack is watching the files…</p>
<p><img src="/img/webpack/w6.png" alt="图片"></p>
<p>然后随便做点修改，保存，webpack就会监听到文件发生了变化，就会重新构建出新的输出文件，并在命令行生成一个记录</p>
<p><img src="/img/webpack/w7.png" alt="图片"></p>
<p>这个时候在手动刷新一些浏览器，可以看到浏览器显示了修改之后的效果，这个方法的缺陷就是还是需要手动刷新浏览器</p>
<ul>
<li>webpack.config.js中配置watch: true</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">const</span> webpackConfig = &#123;</span><br><span class="line">  ...</span><br><span class="line">  watch: <span class="literal">true</span>, <span class="comment">//默认false</span></span><br><span class="line">  watchOptions: &#123;</span><br><span class="line">    ignored: <span class="regexp">/node_modules/</span>, <span class="comment">//不监听的文件夹，支持正则匹配</span></span><br><span class="line">    aggregateTimeout: <span class="number">300</span>, <span class="comment">//监听到发生变化后等待300秒再去执行</span></span><br><span class="line">    poll: <span class="number">1000</span> <span class="comment">//每秒询问1000次文件是否发生变化</span></span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = webpackConfig;</span><br></pre></td></tr></table></figure>
<p>watch: true原理：轮询判断文件的最后编辑时间是否发生变化，设置了aggregate: 300,，检测到某个文件发生了变化，不会立即执行，而是先缓存起来，等待300秒之后再去执行，如果在此期间其他的文件也发生了变化，会一起打包</p>
<p>在命令行运行npm run build，wabpack会进入监听模式。这个方法的缺陷也是需要手动刷新浏览器，所以就需要热更新</p>
<h3 id="热更新"><a href="#热更新" class="headerlink" title="热更新"></a>热更新</h3><h4 id="webpack-dev-server"><a href="#webpack-dev-server" class="headerlink" title="webpack-dev-server"></a>webpack-dev-server</h4><p>webpack-dev-server配合HotModuleReplacementPlugin插件一起使用，以达到热更新的目的</p>
<p>webpack-dev-server：不刷新浏览器，不输入文件，而是放在内存中，构建速度有一定的优势</p>
<p>安装： <code>npm install webpack-dev-server</code></p>
<p>在package.json文件增加一个scripts配置：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1",</span><br><span class="line">    "build": "webpack",</span><br><span class="line">    "watch": "webpack --watch",</span><br><span class="line">    "dev": "webpack-dev-server --open"</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>
<p>webpack-dev-server在开发过程中是不需要使用的，所以修改webpack.config.js文件中的mode配置为development，然后引入webpack内置插件：HotModuleReplacementPlugin插件，同时设置devServer</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line">...</span><br><span class="line"><span class="keyword">const</span> webpackConfig = &#123;</span><br><span class="line">  ...</span><br><span class="line">  mode: <span class="string">'development'</span>,</span><br><span class="line">  plugins: [</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin()</span><br><span class="line">  ],</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    contentBase: <span class="string">'./dist'</span>, <span class="comment">// 服务基础目录</span></span><br><span class="line">    hot: <span class="literal">true</span> <span class="comment">// 开启热更新</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = webpackConfig;</span><br></pre></td></tr></table></figure>
<p>设置好了之后在命令行运行npm run dev，webpack会自动在浏览器打开页面，尝试修改，浏览器也会自动刷新修改后的内容</p>
<p>另外一种热更新的方式webpack-dev-middleWare</p>
<h4 id="webpack-dev-middleWare"><a href="#webpack-dev-middleWare" class="headerlink" title="webpack-dev-middleWare"></a>webpack-dev-middleWare</h4><p>webpack-dev-middleWare将输出的文件传送给服务器</p>
<h4 id="热更新原理"><a href="#热更新原理" class="headerlink" title="热更新原理"></a>热更新原理</h4><p><img src="/img/webpack/w8.png" alt="图片"></p>
<p>热更新的过程</p>
<ol>
<li><p>启动阶段，在文件系统里把文件用webpack compile进行编译，把编译好的文件传输给bundle server,bundle server让打包出来的文件以server的方式浏览器能够访问的到，</p>
</li>
<li><p>如果源代码文件发生了修改，会再次用webpack compile进行编译，编译完成后将代码发送给HMR Server，HMR Server就会知道哪些模块发生了改变，然后通知HMR Runtime哪些文件发生了变化，HMR Runtime负责更新代码，以达到不刷新浏览器改变代码的目的</p>
</li>
</ol>
<h3 id="文件指纹"><a href="#文件指纹" class="headerlink" title="文件指纹"></a>文件指纹</h3><p>打包后输出文件的后缀，做文件的版本的管理，在发布版本的时候，可以只更新有改动的文件，对于没有修改的文件，可以继续使用浏览器的缓存</p>
<p><img src="/img/webpack/w9.png" alt="图片"></p>
<p>由于在开发换进和生产环境可能需要不同的webpack配置，例如热更新只需要在开发环境使用，而文件指纹hash是在开发环境支持的，所有需要区分一下生产环境和开发环境的webpack配置，做法就是首先把之前的webpack.config.js改成webpack.dev.js作为开发环境的配置使用，然后新建名为webpack.prod.js文件，作为开发环境的配置使用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.prod.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> webpackConfig = &#123;</span><br><span class="line">  mode: <span class="string">'production'</span>,</span><br><span class="line">  entry: &#123;</span><br><span class="line">    index: <span class="string">'./src/index.js'</span>,</span><br><span class="line">    login: <span class="string">'./src/login.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>), <span class="comment">//必须是绝对路径</span></span><br><span class="line">    filename: <span class="string">'[name].js'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        use: <span class="string">'babel-loader'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [<span class="string">'style-loader'</span>,<span class="string">'css-loader'</span>]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">        use: [<span class="string">'style-loader'</span>,<span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpg|gif|jpeg)$/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">'url-loader'</span>,</span><br><span class="line">          options: &#123;</span><br><span class="line">            limit: <span class="number">10240</span>, <span class="comment">// 图片小于10k，webpack在打包的时候会自动用base64转换</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// use: 'file-loader'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(woff|woff2|eot|otf|ttf)$/</span>,</span><br><span class="line">        use: [<span class="string">'file-loader'</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">//数组 放着所有的webpack插件</span></span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">        template: <span class="string">'./public/index.html'</span>,</span><br><span class="line">        filename: <span class="string">'index.html'</span>, <span class="comment">//打包后的文件名</span></span><br><span class="line">        minify: &#123;</span><br><span class="line">            removeAttributeQuotes: <span class="literal">false</span>, <span class="comment">//是否删除属性的双引号</span></span><br><span class="line">            collapseWhitespace: <span class="literal">false</span>, <span class="comment">//是否折叠空白</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// hash: true //是否加上hash，默认是 false</span></span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = webpackConfig;</span><br></pre></td></tr></table></figure>
<p>接着修改package.json，指定开发环境使用webpack.dev.js，生产环境使用webpack.prod.js</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// package.json</span><br><span class="line">"scripts": &#123;</span><br><span class="line">    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1",</span><br><span class="line">    "build": "webpack --config webpack.prod.js",</span><br><span class="line">    "watch": "webpack --watch",</span><br><span class="line">    "dev": "webpack-dev-server --config webpack.dev.js --open"</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>
<h4 id="JS文件指纹的设置"><a href="#JS文件指纹的设置" class="headerlink" title="JS文件指纹的设置"></a>JS文件指纹的设置</h4><p>使用ChunkHash，通过设置output的filename哈希值，因为文件指纹是在生产环境使用的，所有在webpack.prod.js配置里面修改</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.prod.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> webpackConfig = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>), <span class="comment">//必须是绝对路径</span></span><br><span class="line">    filename: <span class="string">'[name]_[chunkhash:8].js'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = webpackConfig;</span><br></pre></td></tr></table></figure>
<p>运行npm run build 可以看到dist目录下构建出的js文件带有后缀名hash</p>
<p><img src="/img/webpack/w10.png" alt="图片"></p>
<p>在src/index.js中修改一点文字，再次运行npm run build ，查看dist目录，文件夹里有两个构建出来的index.js文件带有不同的hash后缀，其中一个就是第二次构建的新文件</p>
<p><img src="/img/webpack/w11.png" alt="图片"></p>
<h4 id="图片、其他文件指纹设置"><a href="#图片、其他文件指纹设置" class="headerlink" title="图片、其他文件指纹设置"></a>图片、其他文件指纹设置</h4><p>使用hash，图片使用file-loader的option配置添加指纹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.prod.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> webpackConfig = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpg|gif|jpeg)$/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">'file-loader'</span>,</span><br><span class="line">          options: &#123;</span><br><span class="line">            name: <span class="string">'[name]_[hash:8].[ext]'</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = webpackConfig;</span><br></pre></td></tr></table></figure>
<p>添加好之后，运行npm run build，查看dist目录，可以看到构建出的图片文件添加了hash后缀</p>
<h4 id="css文件指纹，使用contentHash"><a href="#css文件指纹，使用contentHash" class="headerlink" title="css文件指纹，使用contentHash"></a>css文件指纹，使用contentHash</h4><p>前面提到解析css文件使用的style-loader的作用是将样式通过style标签插入到head中，css文件并没有被提构建成一个独立的文件的，所以目前是不能为css文件添加指纹</p>
<p>那么就需要借助MiniCssExtractPlugin这个插件来帮助在构建的时候把css文件提取成一个文件，并添加指纹</p>
<p>首先安装一下： <code>npm i mini-css-extract-plugin -D</code></p>
<p>然后把插件添加到plugin的数组里去，删除style-loader，使用MiniCssExtractPlugin.loader：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.prod.js</span></span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">'mini-css-extract-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> webpackConfig = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [MiniCssExtractPlugin.loader,<span class="string">'css-loader'</span>]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">        use: [MiniCssExtractPlugin.loader,<span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>]</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">      filename: <span class="string">'[name]_[contenthash:8].css'</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = webpackConfig;</span><br></pre></td></tr></table></figure>
<p>运行npm run build查看效果</p>
<h3 id="代码压缩"><a href="#代码压缩" class="headerlink" title="代码压缩"></a>代码压缩</h3><h4 id="js代码压缩"><a href="#js代码压缩" class="headerlink" title="js代码压缩"></a>js代码压缩</h4><p>使用uglifyjs-webpack-plugin，插件uglifyjs-webpack-plugin是webpack4内置的插件，所以正常build构建出的代码就是默认压缩的</p>
<h4 id="css压缩"><a href="#css压缩" class="headerlink" title="css压缩"></a>css压缩</h4><p>使用optimize-css-assets-webpack-plugin插件进行压缩，同时需要安装css预处理器cssnano</p>
<p>首先安装下：<code>npm i optimize-css-assets-webpack-plugin -D</code></p>
<p>安装css预处理器：<code>npm i cssnano -D</code></p>
<p>在webpack.prod.js中配置使用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.prod.js</span></span><br><span class="line"><span class="keyword">const</span> OpimizeCssAssetsPlugin = <span class="built_in">require</span>(<span class="string">'optimize-css-assets-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> webpackConfig = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">new</span> OpimizeCssAssetsPlugin(&#123;</span><br><span class="line">      AccetNameRegExp: <span class="regexp">/\.css$/g</span>,</span><br><span class="line">      cssProcessor: <span class="built_in">require</span>(<span class="string">'cssnano'</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = webpackConfig;</span><br></pre></td></tr></table></figure>
<p>测试效果，删除dist目录，执行npm run build，查看dist目录下构建的css文件</p>
<h4 id="html文件压缩"><a href="#html文件压缩" class="headerlink" title="html文件压缩"></a>html文件压缩</h4><p>前面用到的HtmlWebpackPlugin，可以设置压缩html的参数，压缩空格、换行符号、注释，一个页面对应一个HtmlWebpackPlugin，设置<code>collapseWhitespace: true</code>压缩空格和换行，removeComments: true删除注释</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.prod.js</span></span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> webpackConfig = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">        template: <span class="string">'./public/index.html'</span>,</span><br><span class="line">        filename: <span class="string">'index.html'</span>, <span class="comment">//打包后的文件名</span></span><br><span class="line">        minify: &#123;</span><br><span class="line">            removeAttributeQuotes: <span class="literal">false</span>, <span class="comment">//是否删除属性的双引号</span></span><br><span class="line">            collapseWhitespace: <span class="literal">true</span>, <span class="comment">//是否折叠空白</span></span><br><span class="line">            removeComments: <span class="literal">true</span>, <span class="comment">//删除注释</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// hash: true //是否加上hash，默认是 false</span></span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = webpackConfig;</span><br></pre></td></tr></table></figure>
<p>运行npm run build，在dist目录下找到对应的index.html文件检测效果</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/webpack/" rel="tag"># webpack</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/05/08/print/" rel="next" title="window.print打印设置水印和页头页底">
                <i class="fa fa-chevron-left"></i> window.print打印设置水印和页头页底
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/05/27/webpack-advanced/" rel="prev" title="webpack-进阶配置">
                webpack-进阶配置 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
	  <div id="lv-container" data-id="city" data-uid="MTAyMC8yOTQ0Ny82MDE1"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/images/headphoto.jpg" alt="小心心">
          <p class="site-author-name" itemprop="name">小心心</p>
          <p class="site-description motion-element" itemprop="description">所念皆星河，星河不及你</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/starsight" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/1585017253" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.zhihu.com/people/starsight" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#创建"><span class="nav-number">1.</span> <span class="nav-text">创建</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#尝试运行"><span class="nav-number">2.</span> <span class="nav-text">尝试运行</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#每次运行-node-modules-bin-webpack一长串太麻烦了"><span class="nav-number">2.1.</span> <span class="nav-text">每次运行./node_modules/.bin/webpack一长串太麻烦了</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#简单了解webpack核心概念"><span class="nav-number">3.</span> <span class="nav-text">简单了解webpack核心概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#entry指定打包的入口"><span class="nav-number">3.1.</span> <span class="nav-text">entry指定打包的入口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#output指定webpack编译打包后的文件如何输出到磁盘"><span class="nav-number">3.2.</span> <span class="nav-text">output指定webpack编译打包后的文件如何输出到磁盘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#尝试多入口配置"><span class="nav-number">3.3.</span> <span class="nav-text">尝试多入口配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#loaders"><span class="nav-number">3.4.</span> <span class="nav-text">loaders</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins"><span class="nav-number">3.5.</span> <span class="nav-text">plugins</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mode-webpack4新提出的概念"><span class="nav-number">3.6.</span> <span class="nav-text">mode  webpack4新提出的概念</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#了解webpack基础用法"><span class="nav-number">4.</span> <span class="nav-text">了解webpack基础用法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#在浏览器中查看页面"><span class="nav-number">4.1.</span> <span class="nav-text">在浏览器中查看页面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Babel-loader-解析es6和jsx"><span class="nav-number">4.2.</span> <span class="nav-text">Babel-loader 解析es6和jsx</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#babel如何解析es语法"><span class="nav-number">4.2.1.</span> <span class="nav-text">babel如何解析es语法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Babel如何转换jsx或者vuex语法"><span class="nav-number">4.2.2.</span> <span class="nav-text">Babel如何转换jsx或者vuex语法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#解析css"><span class="nav-number">4.3.</span> <span class="nav-text">解析css</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#css-loader用于加载-css文件，并且转换成commonjs文件，style-loader将样式通过style标签插入到head中"><span class="nav-number">4.3.1.</span> <span class="nav-text">css-loader用于加载.css文件，并且转换成commonjs文件，style-loader将样式通过style标签插入到head中</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#如何使用less-loader和sass-loader"><span class="nav-number">4.3.2.</span> <span class="nav-text">如何使用less-loader和sass-loader</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#解析图片和字体资源"><span class="nav-number">4.4.</span> <span class="nav-text">解析图片和字体资源</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#file-loader解析图片文件"><span class="nav-number">4.4.1.</span> <span class="nav-text">file-loader解析图片文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#file-loader解析字体"><span class="nav-number">4.4.2.</span> <span class="nav-text">file-loader解析字体</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#解析图片和字体文件也可以使用url-loader"><span class="nav-number">4.4.3.</span> <span class="nav-text">解析图片和字体文件也可以使用url-loader</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#webpack中文件的监听"><span class="nav-number">4.5.</span> <span class="nav-text">webpack中文件的监听</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#热更新"><span class="nav-number">4.6.</span> <span class="nav-text">热更新</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#webpack-dev-server"><span class="nav-number">4.6.1.</span> <span class="nav-text">webpack-dev-server</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#webpack-dev-middleWare"><span class="nav-number">4.6.2.</span> <span class="nav-text">webpack-dev-middleWare</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#热更新原理"><span class="nav-number">4.6.3.</span> <span class="nav-text">热更新原理</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文件指纹"><span class="nav-number">4.7.</span> <span class="nav-text">文件指纹</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#JS文件指纹的设置"><span class="nav-number">4.7.1.</span> <span class="nav-text">JS文件指纹的设置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#图片、其他文件指纹设置"><span class="nav-number">4.7.2.</span> <span class="nav-text">图片、其他文件指纹设置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#css文件指纹，使用contentHash"><span class="nav-number">4.7.3.</span> <span class="nav-text">css文件指纹，使用contentHash</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#代码压缩"><span class="nav-number">4.8.</span> <span class="nav-text">代码压缩</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#js代码压缩"><span class="nav-number">4.8.1.</span> <span class="nav-text">js代码压缩</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#css压缩"><span class="nav-number">4.8.2.</span> <span class="nav-text">css压缩</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#html文件压缩"><span class="nav-number">4.8.3.</span> <span class="nav-text">html文件压缩</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">小心心</span>
</div>



<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div style="margin:-20px;position: absolute;right:265px;">
<dl style="float:left">
  <dt style="float:left">
    <dd style="float:left;width:300px">
      <span style="float:right">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span>
      <span style="float:right">本站总访问量<span><span style="float:right" id="busuanzi_value_site_pv"></span>
    </span></span></dd>
  </dt>
  <dt style="float:left;width:300px">
    <dd>
      <span style="float:left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
      <span style="float:left">您是第</span>
      <span style="float:left" id="busuanzi_value_site_uv"></span>
      <span style="float:left">个小伙伴</span>
    </dd>
  </dt>
</dl>
</div>

<span>&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;</span>
<span id="showDays"></span>

<script>
	var birthDay = new Date('04/01/2015');
	var now = new Date();
	var duration = now.getTime() - birthDay.getTime();
	var total= Math.floor(duration / (1000 * 60 * 60 * 24));
	document.getElementById('showDays').innerHTML='本站已运行' + total + '天';
</script>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  
   
     
   
  
       <!-- UY BEGIN -->
       <script type="text/javascript">
          (function(d, s) {
              var j, e = d.getElementsByTagName(s)[0];
              if (typeof LivereTower === 'function') { return; }
              j = d.createElement(s);
              j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
              j.async = true;
              e.parentNode.insertBefore(j, e);
          })(document, 'script');
       </script>
       <noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
       <!-- UY END -->
   
 





  




	





  





  

  
      <!-- UY BEGIN -->
      <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=MTAyMC8yOTQ0Ny82MDE1"></script>
      <!-- UY END -->
  




  
  

  

  

  

  


</body>
</html>
